import {
  ComplianceStatus,
  ControlCenter,
  FleetSummary,
  FleetTimelineEvent,
  FleetVehicle,
} from '../types';

const now = new Date();

const iso = (minutesAgo: number) => {
  const date = new Date(now.getTime() - minutesAgo * 60 * 1000);
  return date.toISOString();
};

export const fleetVehicles: FleetVehicle[] = [
  {
    id: 'ftl-401',
    code: 'TRK-401',
    alias: 'Toluca Express',
    plate: 'XDC-401-23',
    brand: 'Freightliner',
    model: 'Cascadia',
    year: 2023,
    status: 'en_ruta',
    riskLevel: 'medio',
    tags: ['geocerca'],
    lastUpdate: iso(2),
    location: {
      lat: 19.432607,
      lng: -99.133208,
      city: 'Ciudad de México',
      state: 'CDMX',
      country: 'México',
      address: 'Circuito Interior s/n, Centro',
    },
    driver: {
      id: 'drv-129',
      name: 'María Fernanda Molina',
      phone: '+52 55 3210 7890',
      rating: 4.8,
      experienceYears: 6,
      shift: 'matutino',
      assignedSince: '2023-04-10',
      certifications: ['TCC avanzado', 'Carga refrigerada'],
    },
    telemetry: {
      speedKmH: 76,
      avgSpeedKmH: 68,
      engineHours: 2543,
      odometerKm: 184_320,
      coolantTempC: 92,
      fuelLevelPercentage: 54,
      batteryVoltage: 13.9,
      loadKg: 18_500,
      tirePressurePsi: {
        frontLeft: 103,
        frontRight: 102,
        rearLeft: 105,
        rearRight: 104,
      },
      harshEvents24h: 0,
      drivingScore: 93,
    },
    fuel: {
      type: 'diesel',
      levelPercentage: 54,
      autonomyKm: 420,
      consumptionL100Km: 31,
      refillInKm: 280,
      efficiencyVsFleet: 102,
    },
    expenses: {
      monthToDateUsd: 2890,
      lastMaintenanceUsd: 640,
      fuelMonthUsd: 1830,
      tollsMonthUsd: 270,
      averageCostPerKmUsd: 0.84,
    },
    maintenance: [
      {
        id: 'mnt-9901',
        description: 'Cambio de aceite sintético',
        type: 'preventivo',
        dueInKm: 1200,
        dueDate: iso(-7 * 24 * 60),
        priority: 'media',
        workshop: 'Taller CDMX Norte',
      },
      {
        id: 'mnt-9902',
        description: 'Calibración de frenos ABS',
        type: 'preventivo',
        dueInKm: 4500,
        dueDate: iso(-16 * 24 * 60),
        priority: 'baja',
      },
    ],
    activeShipments: [
      {
        id: 'smt-9021',
        type: 'línea_troncal',
        client: 'Logística Nova',
        origin: 'Planta Cuautitlán, Estado de México',
        destination: 'Centro logístico Querétaro',
        eta: iso(-(-95)),
        status: 'en_camino',
        priority: 'alta',
        cargo: {
          description: 'Componentes electrónicos sensibles',
          weightKg: 12_400,
          pallets: 18,
          valueUsd: 380_000,
        },
        checkpoints: [
          { lat: 19.7019, lng: -99.2058, timestamp: iso(90) },
          { lat: 20.0236, lng: -99.3106, timestamp: iso(45) },
          { lat: 20.5881, lng: -100.3899, timestamp: iso(2) },
        ],
      },
    ],
    securityEvents: [
      {
        id: 'sec-441',
        type: 'geocerca',
        severity: 'medio',
        message: 'Cruce anticipado por geocerca “Arco Norte” autorizado.',
        timestamp: iso(18),
        resolved: true,
        actionTaken: 'Ajuste automático de ruta validado por monitoreo.',
      },
    ],
    routeHistory: [
      { lat: 19.6586, lng: -99.0961, timestamp: iso(120), speedKmH: 72 },
      { lat: 19.7847, lng: -99.2213, timestamp: iso(90), speedKmH: 78 },
      { lat: 20.0325, lng: -99.4011, timestamp: iso(60), speedKmH: 74 },
      { lat: 20.2888, lng: -99.9756, timestamp: iso(30), speedKmH: 70 },
      { lat: 20.5881, lng: -100.3899, timestamp: iso(2), speedKmH: 68 },
    ],
  },
  {
    id: 'ftl-275',
    code: 'TRK-275',
    alias: 'Monterrey Shield',
    plate: 'MTY-927-B',
    brand: 'Kenworth',
    model: 'T680',
    year: 2022,
    status: 'detenido',
    riskLevel: 'bajo',
    tags: ['geocerca'],
    lastUpdate: iso(5),
    location: {
      lat: 25.686613,
      lng: -100.316116,
      city: 'Monterrey',
      state: 'Nuevo León',
      country: 'México',
      address: 'Centro de Transferencia La Fé',
    },
    driver: {
      id: 'drv-083',
      name: 'Javier Andrade',
      phone: '+52 81 2001 5544',
      rating: 4.6,
      experienceYears: 8,
      shift: 'vespertino',
      assignedSince: '2022-11-03',
      certifications: ['Transporte de alimentos', 'Telemetría avanzada'],
    },
    telemetry: {
      speedKmH: 0,
      avgSpeedKmH: 61,
      engineHours: 2985,
      odometerKm: 212_440,
      coolantTempC: 78,
      fuelLevelPercentage: 38,
      batteryVoltage: 13.2,
      loadKg: 0,
      tirePressurePsi: {
        frontLeft: 101,
        frontRight: 101,
        rearLeft: 103,
        rearRight: 103,
      },
      harshEvents24h: 1,
      drivingScore: 89,
    },
    fuel: {
      type: 'diesel',
      levelPercentage: 38,
      autonomyKm: 280,
      consumptionL100Km: 29,
      refillInKm: 190,
      efficiencyVsFleet: 97,
    },
    expenses: {
      monthToDateUsd: 2540,
      lastMaintenanceUsd: 890,
      fuelMonthUsd: 1680,
      tollsMonthUsd: 190,
      averageCostPerKmUsd: 0.9,
    },
    maintenance: [
      {
        id: 'mnt-8841',
        description: 'Cambio de kit de frenos traseros',
        type: 'correctivo',
        dueInKm: 80,
        dueDate: iso(6),
        priority: 'alta',
      },
      {
        id: 'mnt-8849',
        description: 'Inspección de sistema telemático',
        type: 'inspección',
        dueInKm: 1200,
        dueDate: iso(-5 * 24 * 60),
        priority: 'media',
      },
    ],
    activeShipments: [
      {
        id: 'smt-7782',
        type: 'última_milla',
        client: 'RetailMax Norte',
        origin: 'CD Montemorelos NL',
        destination: 'Tiendas Región Noreste',
        eta: iso(-(-360)),
        status: 'pendiente',
        priority: 'media',
        cargo: {
          description: 'Línea blanca premium',
          weightKg: 8_200,
          pallets: 12,
          valueUsd: 210_000,
        },
        checkpoints: [
          { lat: 25.5401, lng: -100.9466, timestamp: iso(220) },
          { lat: 25.8706, lng: -100.1309, timestamp: iso(60) },
        ],
      },
    ],
    securityEvents: [
      {
        id: 'sec-991',
        type: 'detencion_no_programada',
        severity: 'bajo',
        message: 'Detención preventiva para inspección de llantas.',
        timestamp: iso(28),
        resolved: true,
        actionTaken: 'Confirmado por supervisor de patio.',
      },
    ],
    routeHistory: [
      { lat: 25.5401, lng: -100.9466, timestamp: iso(320), speedKmH: 82 },
      { lat: 25.6124, lng: -100.7564, timestamp: iso(260), speedKmH: 76 },
      { lat: 25.7122, lng: -100.5603, timestamp: iso(180), speedKmH: 64 },
      { lat: 25.8706, lng: -100.1309, timestamp: iso(60), speedKmH: 42 },
      { lat: 25.6866, lng: -100.3161, timestamp: iso(5), speedKmH: 0 },
    ],
  },
  {
    id: 'ftl-198',
    code: 'TRK-198',
    alias: 'Pacífico Seguro',
    plate: 'JAL-198-X',
    brand: 'Volvo',
    model: 'FH 6x4',
    year: 2021,
    status: 'alerta',
    riskLevel: 'alto',
    tags: ['panic_button', 'apertura_puerta'],
    lastUpdate: iso(1),
    location: {
      lat: 20.659699,
      lng: -103.349609,
      city: 'Guadalajara',
      state: 'Jalisco',
      country: 'México',
      address: 'Periférico Sur y Av. Colón',
    },
    driver: {
      id: 'drv-201',
      name: 'Ricardo Padilla',
      phone: '+52 33 1098 7722',
      rating: 4.3,
      experienceYears: 11,
      shift: 'nocturno',
      assignedSince: '2021-07-30',
      certifications: ['HazMat nivel II', 'Seguridad vial avanzada'],
    },
    telemetry: {
      speedKmH: 12,
      avgSpeedKmH: 58,
      engineHours: 3322,
      odometerKm: 256_780,
      coolantTempC: 97,
      fuelLevelPercentage: 21,
      batteryVoltage: 13.5,
      loadKg: 22_600,
      tirePressurePsi: {
        frontLeft: 98,
        frontRight: 97,
        rearLeft: 101,
        rearRight: 100,
      },
      harshEvents24h: 3,
      drivingScore: 81,
    },
    fuel: {
      type: 'diesel',
      levelPercentage: 21,
      autonomyKm: 140,
      consumptionL100Km: 34,
      refillInKm: 95,
      efficiencyVsFleet: 88,
    },
    expenses: {
      monthToDateUsd: 3180,
      lastMaintenanceUsd: 1100,
      fuelMonthUsd: 2050,
      tollsMonthUsd: 240,
      averageCostPerKmUsd: 1.02,
    },
    maintenance: [
      {
        id: 'mnt-7810',
        description: 'Revisión de sensores de puerta',
        type: 'correctivo',
        dueInKm: 0,
        dueDate: iso(0),
        priority: 'alta',
        workshop: 'Taller Guadalajara Norte',
      },
    ],
    activeShipments: [
      {
        id: 'smt-6612',
        type: 'cruce_frontera',
        client: 'GlobalTrade Co.',
        origin: 'Puerto de Manzanillo',
        destination: 'Planta San Luis Potosí',
        eta: iso(-(-210)),
        status: 'incidencia',
        priority: 'alta',
        cargo: {
          description: 'Equipo médico de alta precisión',
          weightKg: 15_900,
          pallets: 10,
          valueUsd: 1_250_000,
        },
        checkpoints: [
          { lat: 19.0501, lng: -104.3158, timestamp: iso(360) },
          { lat: 20.3319, lng: -103.7546, timestamp: iso(120) },
          { lat: 20.6597, lng: -103.3496, timestamp: iso(1) },
        ],
      },
    ],
    securityEvents: [
      {
        id: 'sec-1187',
        type: 'panic_button',
        severity: 'alto',
        message: 'Botón de pánico presionado, confirmando con operador.',
        timestamp: iso(3),
        resolved: false,
      },
      {
        id: 'sec-1188',
        type: 'apertura_puerta',
        severity: 'alto',
        message: 'Apertura de puerta trasera fuera de geocerca autorizada.',
        timestamp: iso(2),
        resolved: false,
      },
    ],
    routeHistory: [
      { lat: 19.1138, lng: -104.3386, timestamp: iso(400), speedKmH: 90 },
      { lat: 19.8885, lng: -104.0598, timestamp: iso(320), speedKmH: 86 },
      { lat: 20.3319, lng: -103.7546, timestamp: iso(120), speedKmH: 72 },
      { lat: 20.5486, lng: -103.4620, timestamp: iso(60), speedKmH: 48 },
      { lat: 20.6597, lng: -103.3496, timestamp: iso(1), speedKmH: 12 },
    ],
  },
  {
    id: 'ftl-512',
    code: 'TRK-512',
    alias: 'Sureste Verde',
    plate: 'YUC-512-Z',
    brand: 'International',
    model: 'LT Series',
    year: 2024,
    status: 'en_base',
    riskLevel: 'bajo',
    tags: [],
    lastUpdate: iso(12),
    location: {
      lat: 21.161908,
      lng: -86.851528,
      city: 'Cancún',
      state: 'Quintana Roo',
      country: 'México',
      address: 'Centro Logístico Cancún Norte',
    },
    driver: {
      id: 'drv-311',
      name: 'Valeria Cordero',
      phone: '+52 998 882 5511',
      rating: 4.9,
      experienceYears: 4,
      shift: 'matutino',
      assignedSince: '2024-02-12',
      certifications: ['Transporte farmacéutico', 'Gestión eco-driver'],
    },
    telemetry: {
      speedKmH: 0,
      avgSpeedKmH: 55,
      engineHours: 890,
      odometerKm: 45_120,
      coolantTempC: 65,
      fuelLevelPercentage: 87,
      batteryVoltage: 14.1,
      loadKg: 6_800,
      tirePressurePsi: {
        frontLeft: 100,
        frontRight: 100,
        rearLeft: 102,
        rearRight: 102,
      },
      harshEvents24h: 0,
      drivingScore: 96,
    },
    fuel: {
      type: 'gasolina',
      levelPercentage: 87,
      autonomyKm: 610,
      consumptionL100Km: 24,
      refillInKm: 540,
      efficiencyVsFleet: 108,
    },
    expenses: {
      monthToDateUsd: 1470,
      lastMaintenanceUsd: 340,
      fuelMonthUsd: 980,
      tollsMonthUsd: 90,
      averageCostPerKmUsd: 0.65,
    },
    maintenance: [
      {
        id: 'mnt-5540',
        description: 'Actualización de firmware telemático',
        type: 'inspección',
        dueInKm: 600,
        dueDate: iso(-9 * 24 * 60),
        priority: 'baja',
      },
    ],
    activeShipments: [],
    securityEvents: [],
    routeHistory: [
      { lat: 20.9801, lng: -87.1235, timestamp: iso(420), speedKmH: 60 },
      { lat: 21.0502, lng: -86.9956, timestamp: iso(360), speedKmH: 54 },
      { lat: 21.1619, lng: -86.8515, timestamp: iso(12), speedKmH: 0 },
    ],
  },
];

export const controlCenters: ControlCenter[] = [
  {
    id: 'ctr-cdmx',
    name: 'Centro Integrado CDMX',
    coordinates: { lat: 19.433, lng: -99.132 },
    radiusMeters: 3200,
    type: 'almacen',
  },
  {
    id: 'ctr-qro',
    name: 'Planta Querétaro',
    coordinates: { lat: 20.588, lng: -100.389 },
    radiusMeters: 1800,
    type: 'planta',
  },
  {
    id: 'ctr-gdl',
    name: 'Centro de Consolidación Guadalajara',
    coordinates: { lat: 20.65, lng: -103.349 },
    radiusMeters: 2500,
    type: 'almacen',
  },
];

export const fleetSummary: FleetSummary = {
  totalVehicles: 48,
  onRoute: 29,
  idle: 11,
  maintenance: 5,
  alerts: 3,
  totalKmToday: 18_450,
  totalFuelConsumptionL: 6120,
  averageCostPerKmUsd: 0.92,
  emissionsKgCo2: 32_780,
  predictedSavingsUsd: 4280,
  energyDistribution: {
    diesel: 68,
    gasolina: 18,
    gas_natural: 4,
    hibrido: 6,
    electrico: 4,
  },
  safetyScore: 92,
};

export const complianceStatus: ComplianceStatus = {
  insuranceUpToDate: 98,
  maintenanceOnSchedule: 87,
  driversWithValidDocs: 96,
  gpsSignalStable: 94,
};

export const upcomingEvents: FleetTimelineEvent[] = [
  {
    id: 'evt-1001',
    title: 'Mantenimiento preventivo TRK-275',
    description: 'Cambio de frenos traseros programado (Taller Monterrey).',
    category: 'mantenimiento',
    timestamp: iso(-(-240)),
    relatedVehicleId: 'ftl-275',
    severity: 'medio',
  },
  {
    id: 'evt-1002',
    title: 'Auditoría de seguridad mensual',
    description: 'Revisión de rutas de alto riesgo y protocolos de panic button.',
    category: 'seguridad',
    timestamp: iso(-(-360)),
    severity: 'bajo',
  },
  {
    id: 'evt-1003',
    title: 'Simulación de contingencia carretera 57',
    description: 'Ensayo regional con Guardia Nacional y centros de monitoreo.',
    category: 'operaciones',
    timestamp: iso(-(-1440)),
    severity: 'bajo',
  },
];
